# Nginx Configuration for Single Page Application (SPA)
#
# This configuration file enables proper routing for React/Vue/Angular SPAs
# when deployed on nginx servers. It ensures that page refreshes on any route
# (e.g., /home, /products, /cart) will serve index.html and let the client-side
# router handle the navigation.
#
# HOW TO USE:
# 1. If you have access to the nginx configuration, include this file or copy
#    the location block into your server block.
#
# 2. Example nginx.conf usage:
#    server {
#        listen 80;
#        server_name yourdomain.com;
#        root /var/www/mart-for-you/dist;
#        include /path/to/this/nginx.conf;
#    }
#
# 3. Or copy the location blocks directly into your server configuration.
#
# ALTERNATIVE: If you don't have nginx access, the app now uses HashRouter
# which works without server configuration (URLs: domain.com/#/home)

# Serve static files with caching
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    try_files $uri =404;
}

# Handle all other routes - serve index.html for SPA routing
location / {
    # First attempt to serve request as file, then as directory,
    # then fall back to serving index.html
    try_files $uri $uri/ /index.html;
    
    # Disable caching for index.html to ensure users get the latest version
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";
}

# Security headers (optional but recommended)
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Gzip compression (optional but recommended)
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_proxied expired no-cache no-store private auth;
gzip_types
    text/plain
    text/css
    text/xml
    text/javascript
    application/javascript
    application/json
    application/xml
    application/xml+rss
    image/svg+xml;
